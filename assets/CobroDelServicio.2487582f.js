import{M as E}from"./MazBtn-000f9f66.7616eae6.js";import{M as L}from"./MazDialog-d5f6a7d8.b85dea5d.js";import{u as $,r as s,v as w,l as T,x as H,c as J,b as l,f as u,w as d,E as z,B as r,C as O,F as U,o as K,g as f,t as n}from"./entry.fe1998f0.js";import{M as P}from"./MazInput-8e284503.4cd36a02.js";const R={class:"bg-slate-400"},Z={class:"container p-4"},j=l("h1",{style:{color:"black","font-family":"Verdana","font-size":"36px"}},[l("b",null,"Salida de Vehículos")],-1),q={class:"w-3/4 border bg-gradienttwo p-8 rounded-lg shadow-md"},G=l("h2",{style:{color:"white","font-family":"Verdana","font-size":"36px"},class:"mt-8"}," Datos del vehículo: ",-1),ae={__name:"CobroDelServicio",setup(Q){const k=$();let a=s(""),y=s(20),I=s(""),b=s(new Date().toLocaleTimeString()),h=s(new Date().toLocaleDateString());const v=s(!1),_=s(""),D=s(0);let c=s(0),p=[],S=[],V=[];const N=()=>{b.value=new Date().toLocaleTimeString()};w(()=>{setInterval(N,1e3)}),T(()=>{clearInterval(N)});const x=()=>{h.value=new Date().toLocaleDateString()};w(()=>{setInterval(x,1e3)}),T(()=>{clearInterval(x)}),w(()=>{p=JSON.parse(localStorage.getItem("entrada"))||[],S=JSON.parse(localStorage.getItem("costosEVehiculos"))||[],V=JSON.parse(localStorage.getItem("servicios"))||[];const i=localStorage.getItem("lugDisp")||20;i!==null&&(y.value=parseInt(i))}),H();function M(){/^[A-Z]{3}\d{3}[A-Z]$/.test(a.value)&&(a.value=`${a.value.slice(0,3)}-${a.value.slice(3,6)}-${a.value.slice(6)}`);const t=p.find(o=>o.placa==a.value);if(t){I=t.hora;let o=A(b.value,t.hora);if(o<1){let e=S.find(g=>g.tiempoEstancia=="Menos de 1 hora");e?e=Number(e.precio.substring(1)):e=10,c.value=e.toFixed(2)}else{let e=Number(S.find(g=>g.tiempoEstancia=="1 hora"));e?e=Number(e.precio.substring(1)):e=20,c.value=(e*o).toFixed(2)}const m=V.filter(e=>e.placaDos==a.value);m.length>0&&m.forEach(e=>{c.value=Number(c.value)+Number(e.costo.substring(1)),D.value=Number(D.value)+Number(e.costo.substring(1)),c.value=c.value.toFixed(2)}),C()}else k.error("Placa no encontrada",{position:"bottom",timeout:3e3})}function A(i,t){let o=new Date("2000-01-01 "+i),m=new Date("2000-01-01 "+t),e=o.getTime()-m.getTime();return`${Math.floor(e/36e5)}`}function C(){_.value=new Date().toLocaleTimeString(),v.value=!0}function B(){v.value=!1;const i=p.findIndex(t=>t.placa==a.value);p[i].salida=_.value,localStorage.setItem("entrada",JSON.stringify(p)),k.success("Cobro registrado exitosamente",{position:"bottom",timeout:3e3})}const F=()=>{a.value=a.value.toUpperCase()};return(i,t)=>{const o=E,m=L;return K(),J("section",R,[l("div",Z,[j,u(o,{class:"mt-8 mb-5 mr-3",style:z({backgroundColor:"rgba(0, 0, 0, 0.5)"})},{default:d(()=>[f("Hora actual: "+n(r(b)),1)]),_:1},8,["style"]),u(o,{class:"mt-8 mb-5",style:z({backgroundColor:"rgba(0, 0, 0, 0.5)"})},{default:d(()=>[f("Fecha actual: "+n(r(h)),1)]),_:1},8,["style"]),l("div",q,[G,u(r(P),{class:"mb-1",modelValue:r(a),"onUpdate:modelValue":t[0]||(t[0]=e=>O(a)?a.value=e:a=e),onInput:F,onKeyup:U(M,["enter"]),label:"Placa",disabled:r(y)===0},null,8,["modelValue","onKeyup","disabled"])]),u(o,{rounded:"",class:"mt-6 w-40",color:"black",pastel:"",onClick:M},{default:d(()=>[f("Buscar")]),_:1})]),l("div",null,[u(o,{rounded:"",class:"mt-6 w-40",color:"black",pastel:"",onClick:C},{default:d(()=>[f("Imprimir ticket")]),_:1}),u(m,{modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=e=>v.value=e),title:"Detalle del Ticket",noClose:""},{footer:d(()=>[u(o,{onClick:B,color:"success"},{default:d(()=>[f("Cobrar")]),_:1})]),default:d(()=>[l("p",null,"Placa: "+n(r(a)),1),l("p",null,"Hora de entrada: "+n(r(I)),1),l("p",null,"Hora de salida: "+n(_.value),1),l("p",null,"Fecha: "+n(r(h)),1),l("p",null,"Servicios Adicionales: $"+n(D.value??0),1),l("p",null,"Total: $"+n(r(c)),1)]),_:1},8,["modelValue"])])])}}};export{ae as default};
