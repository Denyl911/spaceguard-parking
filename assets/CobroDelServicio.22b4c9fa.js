import{M as $}from"./MazBtn-000f9f66.4f02c25b.js";import{M as H}from"./MazDialog-d5f6a7d8.3f74c989.js";import{u as J,r as s,v as S,l as T,x as O,c as z,b as l,f as u,w as d,E as A,B as r,C as U,F as K,o as B,g as f,t as n,L as P}from"./entry.fd85b3d7.js";import{M as R}from"./MazInput-8e284503.e507e32a.js";const Z={class:"bg-slate-400"},j={class:"container p-4"},q=l("h1",{style:{color:"black","font-family":"Verdana","font-size":"36px"}},[l("b",null,"Salida de Vehículos")],-1),G={class:"w-3/4 border bg-gradienttwo p-8 rounded-lg shadow-md"},Q=l("h2",{style:{color:"white","font-family":"Verdana","font-size":"36px"},class:"mt-8"}," Datos del vehículo: ",-1),W={key:0},oe={__name:"CobroDelServicio",setup(X){const k=J();let a=s(""),w=s(20),y=s(""),b=s(new Date().toLocaleTimeString()),h=s(new Date().toLocaleDateString());s(!1);const v=s(!1),_=s(""),V=s("");let c=s(0),p=[],D=[],I=[];const x=()=>{b.value=new Date().toLocaleTimeString()};S(()=>{setInterval(x,1e3)}),T(()=>{clearInterval(x)});const C=()=>{h.value=new Date().toLocaleDateString()};S(()=>{setInterval(C,1e3)}),T(()=>{clearInterval(C)}),S(()=>{p=JSON.parse(localStorage.getItem("entrada"))||[],D=JSON.parse(localStorage.getItem("costosEVehiculos"))||[],I=JSON.parse(localStorage.getItem("servicios"))||[];const i=localStorage.getItem("lugDisp");i!==null&&(w.value=parseInt(i))}),O();function M(){/^[A-Z]{3}\d{3}[A-Z]$/.test(a.value)&&(a.value=`${a.value.slice(0,3)}-${a.value.slice(3,6)}-${a.value.slice(6)}`);const t=p.find(o=>o.placa==a.value);if(t){y=t.hora;let o=F(b.value,t.hora);if(o<1){let e=D.find(g=>g.tiempoEstancia=="Menos de 1 hora");e?e=Number(e.precio.substring(1)):e=10,c.value=e.toFixed(2)}else{let e=Number(D.find(g=>g.tiempoEstancia=="1 hora"));e?e=Number(e.precio.substring(1)):e=20,c.value=(e*o).toFixed(2)}const m=I.filter(e=>e.placaDos==a.value);m.length>0&&m.forEach(e=>{c.value=Number(c.value)+Number(e.costo.substring(1)),c=c.value.toFixed(2)}),N()}else k.error("Placa no encontrada",{position:"bottom",timeout:3e3})}function F(i,t){let o=new Date("2000-01-01 "+i),m=new Date("2000-01-01 "+t),e=o.getTime()-m.getTime();return`${Math.floor(e/36e5)}`}function N(){_.value=new Date().toLocaleTimeString(),v.value=!0}function L(){v.value=!1;const i=p.findIndex(t=>t.placa==a.value);p[i].salida=_.value,localStorage.setItem("entrada",JSON.stringify(p)),k.success("Cobro registrado exitosamente",{position:"bottom",timeout:3e3})}const E=()=>{a.value=a.value.toUpperCase()};return(i,t)=>{const o=$,m=H;return B(),z("section",Z,[l("div",j,[q,u(o,{class:"mt-8 mb-5 mr-3",style:A({backgroundColor:"rgba(0, 0, 0, 0.5)"})},{default:d(()=>[f("Hora actual: "+n(r(b)),1)]),_:1},8,["style"]),u(o,{class:"mt-8 mb-5",style:A({backgroundColor:"rgba(0, 0, 0, 0.5)"})},{default:d(()=>[f("Fecha actual: "+n(r(h)),1)]),_:1},8,["style"]),l("div",G,[Q,u(r(R),{class:"mb-1",modelValue:r(a),"onUpdate:modelValue":t[0]||(t[0]=e=>U(a)?a.value=e:a=e),onInput:E,onKeyup:K(M,["enter"]),label:"Placa",disabled:r(w)===0},null,8,["modelValue","onKeyup","disabled"])]),u(o,{rounded:"",class:"mt-6 w-40",color:"black",pastel:"",onClick:M},{default:d(()=>[f("Buscar")]),_:1})]),l("div",null,[u(o,{rounded:"",class:"mt-6 w-40",color:"black",pastel:"",onClick:N},{default:d(()=>[f("Imprimir ticket")]),_:1}),u(m,{modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=e=>v.value=e),title:"Detalle del Ticket",noClose:""},{footer:d(()=>[u(o,{onClick:L,color:"success"},{default:d(()=>[f("Cobrar")]),_:1})]),default:d(()=>[l("p",null,"Placa: "+n(r(a)),1),l("p",null,"Hora de entrada: "+n(r(y)),1),l("p",null,"Hora de salida: "+n(_.value),1),l("p",null,"Fecha: "+n(r(h)),1),V.value?(B(),z("p",W,"Servicios Adicionales: $"+n(V.value),1)):P("",!0),l("p",null,"Total: $"+n(r(c)),1)]),_:1},8,["modelValue"])])])}}};export{oe as default};
