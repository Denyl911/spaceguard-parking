import{M as F}from"./MazBtn-000f9f66.6fed24bc.js";import{M as H}from"./MazDialog-d5f6a7d8.3a72cbdc.js";import{u as L,r as s,l as $,v as J,x as O,c as N,b as l,f as m,w as p,G as k,B as i,C as U,H as K,o as C,g,t as c,E as P}from"./entry.20fd3aae.js";import{M as R}from"./MazInput-8e284503.0fb23997.js";/* empty css                 */const Z={class:"bg-slate-400"},G={class:"container p-4"},j=l("h1",{style:{color:"black","font-family":"Verdana","font-size":"36px"}},[l("b",null,"Salida de Vehículos")],-1),q={class:"w-3/4 border bg-gradienttwo p-8 rounded-lg shadow-md"},Q=l("h2",{style:{color:"white","font-family":"Verdana","font-size":"36px"},class:"mt-8"}," Datos del vehículo: ",-1),W={key:0},le={__name:"CobroDelServicio",setup(X){const S=L();let a=s(""),T=s(20),y=s(""),b=s(new Date().toLocaleTimeString()),h=s(new Date().toLocaleDateString());s(!1);const f=s(!1),_=s(""),V=s("");let n=s(0),u,D,w;const I=()=>{b.value=new Date().toLocaleTimeString()},x=()=>{h.value=new Date().toLocaleDateString()};$(()=>{clearInterval(I),clearInterval(x)}),J(()=>{u=JSON.parse(localStorage.getItem("entrada")),D=JSON.parse(localStorage.getItem("costosEVehiculos")),w=JSON.parse(localStorage.getItem("servicios"));const r=localStorage.getItem("lugDisp");r!==null&&(T.value=parseInt(r)),setInterval(x,1e3),setInterval(I,1e3)}),O();function M(){/^[A-Z]{3}\d{3}[A-Z]$/.test(a.value)&&(a.value=`${a.value.slice(0,3)}-${a.value.slice(3,6)}-${a.value.slice(6)}`);const t=u.find(o=>o.placa==a.value);if(t){y=t.hora;let o=z(b.value,t.hora);if(o<1){let e=D.find(v=>v.tiempoEstancia=="Menos de 1 hora");e?e=Number(e.precio.substring(1)):e=10,n.value=e.toFixed(2)}else{let e=Number(D.find(v=>v.tiempoEstancia=="1 hora"));e?e=Number(e.precio.substring(1)):e=20,n.value=(e*o).toFixed(2)}const d=w.filter(e=>e.placaDos==a.value);d.length>0&&d.forEach(e=>{n.value=Number(n.value)+Number(e.costo.substring(1)),n.value=n.value.toFixed(2)}),A()}else S.error("Placa no encontrada",{position:"bottom",timeout:3e3})}function z(r,t){let o=new Date("2000-01-01 "+r),d=new Date("2000-01-01 "+t),e=o.getTime()-d.getTime();return`${Math.floor(e/36e5)}`}function A(){_.value=new Date().toLocaleTimeString(),f.value=!0}function B(){f.value=!1;const r=u.findIndex(t=>t.placa==a.value);u[r].salida=_.value,u[r].total=n.value,localStorage.setItem("entrada",JSON.stringify(u)),S.success("Cobro registrado exitosamente",{position:"bottom",timeout:3e3})}const E=()=>{a.value=a.value.toUpperCase()};return(r,t)=>{const o=F,d=H;return C(),N("section",Z,[l("div",G,[j,m(o,{class:"mt-8 mb-5 mr-3",style:k({backgroundColor:"rgba(0, 0, 0, 0.5)"})},{default:p(()=>[g("Hora actual: "+c(i(b)),1)]),_:1},8,["style"]),m(o,{class:"mt-8 mb-5",style:k({backgroundColor:"rgba(0, 0, 0, 0.5)"})},{default:p(()=>[g("Fecha actual: "+c(i(h)),1)]),_:1},8,["style"]),l("div",q,[Q,m(i(R),{class:"mb-1",modelValue:i(a),"onUpdate:modelValue":t[0]||(t[0]=e=>U(a)?a.value=e:a=e),onInput:E,onKeyup:K(M,["enter"]),label:"Placa"},null,8,["modelValue","onKeyup"])]),m(o,{rounded:"",class:"mt-6 w-52 mr-32",color:"secondary",onClick:M},{default:p(()=>[g("Buscar")]),_:1})]),l("div",null,[m(d,{modelValue:f.value,"onUpdate:modelValue":t[1]||(t[1]=e=>f.value=e),title:"Detalle del Ticket",noClose:""},{footer:p(()=>[m(o,{onClick:B,color:"success"},{default:p(()=>[g("Cobrar")]),_:1})]),default:p(()=>[l("p",null,"Placa: "+c(i(a)),1),l("p",null,"Hora de entrada: "+c(i(y)),1),l("p",null,"Hora de salida: "+c(_.value),1),l("p",null,"Fecha: "+c(i(h)),1),V.value?(C(),N("p",W,"Servicios Adicionales: $"+c(V.value),1)):P("",!0),l("p",null,"Total: $"+c(i(n)),1)]),_:1},8,["modelValue"])])])}}};export{le as default};
