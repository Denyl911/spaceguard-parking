import{M as $}from"./MazBtn-000f9f66.1d4b1829.js";import{M as E}from"./MazDialog-d5f6a7d8.0c44c412.js";import{u as J,r as s,v as S,l as T,x as O,c as z,b as l,f as u,w as d,F as A,B as i,C as U,G as K,o as B,g as f,t as c,H as P}from"./entry.4c593aaa.js";import{M as R}from"./MazInput-8e284503.fe76a03e.js";/* empty css                 */const Z={class:"bg-slate-400"},G={class:"container p-4"},j=l("h1",{style:{color:"black","font-family":"Verdana","font-size":"36px"}},[l("b",null,"Salida de Vehículos")],-1),q={class:"w-3/4 border bg-gradienttwo p-8 rounded-lg shadow-md"},Q=l("h2",{style:{color:"white","font-family":"Verdana","font-size":"36px"},class:"mt-8"}," Datos del vehículo: ",-1),W={key:0},le={__name:"CobroDelServicio",setup(X){const y=J();let a=s(""),w=s(20),V=s(""),b=s(new Date().toLocaleTimeString()),h=s(new Date().toLocaleDateString());s(!1);const v=s(!1),_=s(""),k=s("");let n=s(0),m,D,I;const x=()=>{b.value=new Date().toLocaleTimeString()};S(()=>{setInterval(x,1e3)}),T(()=>{clearInterval(x)});const C=()=>{h.value=new Date().toLocaleDateString()};S(()=>{setInterval(C,1e3)}),T(()=>{clearInterval(C)}),S(()=>{m=JSON.parse(localStorage.getItem("entrada")),D=JSON.parse(localStorage.getItem("costosEVehiculos")),I=JSON.parse(localStorage.getItem("servicios"));const r=localStorage.getItem("lugDisp");r!==null&&(w.value=parseInt(r))}),O();function M(){/^[A-Z]{3}\d{3}[A-Z]$/.test(a.value)&&(a.value=`${a.value.slice(0,3)}-${a.value.slice(3,6)}-${a.value.slice(6)}`);const t=m.find(o=>o.placa==a.value);if(t){V=t.hora;let o=F(b.value,t.hora);if(o<1){let e=D.find(g=>g.tiempoEstancia=="Menos de 1 hora");e?e=Number(e.precio.substring(1)):e=10,n.value=e.toFixed(2)}else{let e=Number(D.find(g=>g.tiempoEstancia=="1 hora"));e?e=Number(e.precio.substring(1)):e=20,n.value=(e*o).toFixed(2)}const p=I.filter(e=>e.placaDos==a.value);p.length>0&&p.forEach(e=>{n.value=Number(n.value)+Number(e.costo.substring(1)),n.value=n.value.toFixed(2)}),N()}else y.error("Placa no encontrada",{position:"bottom",timeout:3e3})}function F(r,t){let o=new Date("2000-01-01 "+r),p=new Date("2000-01-01 "+t),e=o.getTime()-p.getTime();return`${Math.floor(e/36e5)}`}function N(){_.value=new Date().toLocaleTimeString(),v.value=!0}function H(){v.value=!1;const r=m.findIndex(t=>t.placa==a.value);m[r].salida=_.value,m[r].total=n.value,localStorage.setItem("entrada",JSON.stringify(m)),y.success("Cobro registrado exitosamente",{position:"bottom",timeout:3e3})}const L=()=>{a.value=a.value.toUpperCase()};return(r,t)=>{const o=$,p=E;return B(),z("section",Z,[l("div",G,[j,u(o,{class:"mt-8 mb-5 mr-3",style:A({backgroundColor:"rgba(0, 0, 0, 0.5)"})},{default:d(()=>[f("Hora actual: "+c(i(b)),1)]),_:1},8,["style"]),u(o,{class:"mt-8 mb-5",style:A({backgroundColor:"rgba(0, 0, 0, 0.5)"})},{default:d(()=>[f("Fecha actual: "+c(i(h)),1)]),_:1},8,["style"]),l("div",q,[Q,u(i(R),{class:"mb-1",modelValue:i(a),"onUpdate:modelValue":t[0]||(t[0]=e=>U(a)?a.value=e:a=e),onInput:L,onKeyup:K(M,["enter"]),label:"Placa",disabled:i(w)===0},null,8,["modelValue","onKeyup","disabled"])]),u(o,{rounded:"",class:"mt-6 w-52 mr-32",color:"secondary",onClick:M},{default:d(()=>[f("Buscar")]),_:1}),u(o,{rounded:"",class:"mt-6 w-40",color:"black",pastel:"",onClick:N},{default:d(()=>[f("Imprimir ticket")]),_:1})]),l("div",null,[u(p,{modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=e=>v.value=e),title:"Detalle del Ticket",noClose:""},{footer:d(()=>[u(o,{onClick:H,color:"success"},{default:d(()=>[f("Cobrar")]),_:1})]),default:d(()=>[l("p",null,"Placa: "+c(i(a)),1),l("p",null,"Hora de entrada: "+c(i(V)),1),l("p",null,"Hora de salida: "+c(_.value),1),l("p",null,"Fecha: "+c(i(h)),1),k.value?(B(),z("p",W,"Servicios Adicionales: $"+c(k.value),1)):P("",!0),l("p",null,"Total: $"+c(i(n)),1)]),_:1},8,["modelValue"])])])}}};export{le as default};
